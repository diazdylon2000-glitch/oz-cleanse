<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Oz Companion</title>
  <meta name="theme-color" content="#f9c2a7" />

  <!-- Styles -->
  <link rel="stylesheet" href="style.css" />
  <link rel="manifest" href="manifest.webmanifest" />
</head>
<body>
  <!-- Error banner (CDN issues, runtime errors, etc.) -->
  <div id="errorBanner" style="display:none;position:fixed;top:0;left:0;right:0;background:#ef4444;color:#fff;padding:10px;font-size:14px;z-index:10000;text-align:center"></div>

  <!-- Splash / Loader -->
  <div id="ozSplash" class="splash">
    <img id="ozImg" alt="Oz" src="oz.png" />
  </div>
  <div id="ozBubble" class="bubble">Hydration is happiness 🐾</div>

  <!-- React app root -->
  <div id="root"></div>

  <!-- React + Chart.js + Confetti (with robust fallbacks) -->
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin
          onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/npm/react@18/umd/react.production.min.js'"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin
          onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/npm/react-dom@18/umd/react-dom.production.min.js'"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js" crossorigin
          onerror="this.onerror=null;this.src='https://unpkg.com/chart.js@4.4.3/dist/chart.umd.js'"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js" crossorigin
          onerror="this.onerror=null;this.src='https://unpkg.com/canvas-confetti@1.6.0/dist/confetti.browser.min.js'"></script>

  <!-- Splash text + robust auto-hide + error banner -->
  <script>
  (function () {
    // Random splash line
    var lines = [
      "You’ve got this!","Small habits, big change","Progress, not perfection",
      "Sip, breathe, reset","Strong body, calm mind","Hydration is happiness 🐾",
      "Future-you says thanks","Gentle + consistent + kind","Shine time ✨",
      "Keep it playful","You’re doing the work 💪"
    ];
    var b = document.getElementById("ozBubble");
    if (b) b.textContent = lines[Math.floor(Math.random() * lines.length)];

    // CDN check -> banner
    function banner(msg){
      var el = document.getElementById('errorBanner');
      if(!el) return; el.textContent = msg; el.style.display = 'block';
    }
    var issues=[];
    if(!window.React) issues.push("React");
    if(!window.ReactDOM) issues.push("ReactDOM");
    if(!window.Chart) issues.push("Chart.js");
    if(issues.length){ banner("CDN failed: " + issues.join(", ") + ". Reload or try another network."); }

    // Robust splash hider: fade if possible, hard-hide regardless
    function hideSplashNow(){
      var s=document.getElementById("ozSplash");
      var bb=document.getElementById("ozBubble");
      if(s) s.style.display="none";
      if(bb) bb.style.display="none";
    }
    function fadeThenHide(){
      var s=document.getElementById("ozSplash");
      var bb=document.getElementById("ozBubble");
      if(s) s.classList.add("fade-out");     // support fade-out
      if(bb) bb.classList.add("fade-out");
      setTimeout(hideSplashNow, 700);
    }
    window.addEventListener("load", function(){
      setTimeout(fadeThenHide, 200);
    });
    // Safety net even if load listener never runs
    setTimeout(hideSplashNow, 2200);

    // Runtime error -> banner
    window.addEventListener("error", function(e){
      var el=document.getElementById('errorBanner');
      if(!el) return;
      el.textContent='Error: ' + (e.error && e.error.message ? e.error.message : e.message);
      el.style.display='block';
    });
  })();
  </script>

  <!-- Your app -->
  <script src="app.js"></script>
</body>
</html>
